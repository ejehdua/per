<!doctype html>
<html lang="he" dir="rtl">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>פרופיל תלמיד השלם</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      background-attachment: fixed;
      min-height: 100%;
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 40% 40%, rgba(120, 219, 226, 0.2) 0%, transparent 50%);
      pointer-events: none;
      z-index: -1;
    }

    html {
      height: 100%;
    }

    .container {
      width: 90%;
      max-width: 1200px;
      padding: 40px 20px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 50px;
    }

    .header h1 {
      color: #ffffff;
      font-size: 48px;
      margin: 0;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }

    .content-wrapper {
      display: flex;
      gap: 40px;
      align-items: center;
      flex-wrap: wrap;
      justify-content: center;
      min-height: 600px;
    }

    .circles-container {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      min-width: 600px;
      min-height: 600px;
    }

    .main-circle {
      position: absolute;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      border: 3px solid rgba(255,255,255,0.3);
      width: 140px;
      height: 140px;
    }

    .main-circle:hover {
      transform: scale(1.1);
      box-shadow: 0 12px 35px rgba(0,0,0,0.25);
    }

    .main-circle.active {
      transform: scale(1.2);
      z-index: 100;
      box-shadow: 0 15px 45px rgba(0,0,0,0.35);
    }

    .main-circle.dimmed {
      opacity: 0.4;
      transform: scale(0.9);
    }

    .circle-label {
      color: white;
      font-weight: bold;
      font-size: 16px;
      text-align: center;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
      padding: 15px;
      line-height: 1.2;
      max-width: 110px;
    }

    .sub-circle {
      position: absolute;
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: rgba(255,255,255,0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: bold;
      text-align: center;
      padding: 12px;
      box-sizing: border-box;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      border: 2px solid;
      opacity: 0;
      transform: scale(0);
      transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      cursor: pointer;
      z-index: 50;
      line-height: 1.1;
      overflow: hidden;
    }

    .sub-circle.show {
      opacity: 1;
      transform: scale(1);
    }

    .sub-circle:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    }

    .details-panel {
      flex: 1;
      min-width: 300px;
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      min-height: 400px;
    }

    .details-panel h2 {
      color: #667eea;
      margin-top: 0;
      margin-bottom: 20px;
      font-size: 28px;
      border-bottom: 3px solid #667eea;
      padding-bottom: 10px;
    }

    .details-panel ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .details-panel li {
      padding: 15px 0;
      border-bottom: 1px solid #e0e0e0;
      font-size: 16px;
      color: #333;
      position: relative;
    }

    .details-panel li:last-child {
      border-bottom: none;
    }

    .detail-title {
      font-weight: bold;
      color: #333;
      margin-bottom: 8px;
      font-size: 16px;
      position: relative;
      padding-right: 25px;
    }

    .detail-title:before {
      content: "✓";
      position: absolute;
      right: 0;
      color: #667eea;
      font-weight: bold;
    }

    .detail-definition {
      color: #666;
      font-size: 14px;
      line-height: 1.5;
      margin-top: 5px;
      font-weight: normal;
    }

    .placeholder-text {
      color: #999;
      font-style: italic;
      text-align: center;
      padding: 40px 20px;
    }

    .legend-section {
      background: rgba(255,255,255,0.95);
      border-radius: 15px;
      padding: 25px;
      margin-top: 20px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
    }

    .legend-section h3 {
      color: #667eea;
      margin-top: 0;
      margin-bottom: 15px;
      font-size: 20px;
      border-bottom: 2px solid #667eea;
      padding-bottom: 8px;
    }

    .legend-item {
      display: flex;
      margin-bottom: 12px;
      padding: 8px 0;
      border-bottom: 1px solid #f0f0f0;
    }

    .legend-item:last-child {
      border-bottom: none;
    }

    .legend-term {
      font-weight: bold;
      color: #333;
      min-width: 200px;
      margin-left: 15px;
      flex-shrink: 0;
    }

    .legend-definition {
      color: #666;
      line-height: 1.4;
    }

    @media (max-width: 768px) {
      .content-wrapper {
        flex-direction: column;
        min-height: 500px;
      }

      .circles-container {
        min-width: 400px;
        min-height: 400px;
      }

      .main-circle {
        width: 80px !important;
        height: 80px !important;
      }

      .circle-label {
        font-size: 12px;
        max-width: 60px;
      }

      .sub-circle {
        width: 80px;
        height: 80px;
        font-size: 9px;
        padding: 8px;
      }

      .header h1 {
        font-size: 32px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="container">
   <div class="header">
    <h1 id="main-title">פרופיל תלמיד השלם</h1>
   </div>
   <div class="content-wrapper">
    <div class="circles-container" id="circlesContainer"><!-- העיגולים ייווצרו דינמית -->
    </div>
    <div class="details-panel" id="detailsPanel">
     <p class="placeholder-text">לחץ על אחד מהעיגולים כדי לראות פירוט</p>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      main_title: "פרופיל תלמיד השלם",
      primary_color: "#667eea",
      secondary_color: "#764ba2",
      text_color: "#ffffff",
      background_color: "#ffffff",
      accent_color: "#e0e0e0",
      font_family: "Segoe UI",
      font_size: 16
    };

    const categories = [
      {
        name: "נתונים אישיים",
        color: "#FF6B6B",
        details: [
          "נתונים דמוגרפיים בסיסיים",
          "רקע משפחתי",
          "מצב חברתי ושייכות",
          "חוזקות אישיות",
          "אתגרים אישיים",
          "התאמות בלמידה"
        ],
        legend: {
          "נתונים דמוגרפיים בסיסיים": "גיל, מגדר, שכבת גיל, מסגרת לימודים, מגמה או תחום התמחות.",
          "רקע משפחתי": "מבנה משפחתי, מצב כלכלי־חברתי כללי, גורמי תמיכה משמעותיים בבית.",
          "מצב חברתי ושייכות": "יחסים בין־אישיים בכיתה ובבית הספר, רמת תחושת שייכות לקבוצה, מעורבות חברתית.",
          "חוזקות אישיות": "תחומים שבהם הלומד מצטיין או מגלה ביטוי חיובי – קוגניטיבי, רגשי, חברתי או יצירתי.",
          "אתגרים אישיים": "תחומים שבהם הלומד מתמודד עם קושי מתמשך, פער או חסם תפקודי/רגשי/חברתי.",
          "התאמות בלמידה": "התאמות פדגוגיות או טכנולוגיות הניתנות ללומד לצורך למידה מיטבית (כגון: הארכת זמן, סיוע בקריאה, סביבה מותאמת)."
        }
      },
      {
        name: "ידע",
        color: "#45B7D1",
        details: [
          "ידע עולם",
          "ידע קודם דיסיפלינרי",
          "תפיסות שגויות",
          "ידע נרכש",
          "רמות חשיבה"
        ],
        legend: {
          "ידע עולם": "הידע הרחב שהלומד מביא מעולמו החברתי, התרבותי והאישי, שאינו תלוי בתוכן הלימודי הספציפי.",
          "ידע קודם דיסיפלינרי": "הידע התוכני שהלומד כבר רכש בתחום דעת מסוים – למשל, מושגים, דמויות, אירועים, הבנה של מונחים, עקרונות, או תהליכים רלוונטיים לנושא הנלמד.",
          "תפיסות שגויות": "הבנות לא מדויקות, הנחות יסוד מוטעות או דפוסי חשיבה שגויים שהלומד פיתח לאורך הדרך – לעיתים בעקבות ניסיון אישי, הוראה לא עקבית או הכללות שגויות.",
          "ידע נרכש": "הידע החדש שנלמד בפועל בתהליך הלמידה – מושגים, כלים, עקרונות או קשרים שנוצרו בעקבות חשיפה לתוכן חדש. הידע הנרכש נבנה על בסיס הידע הקודם אך מרחיב ומעמיק אותו.",
          "רמות חשיבה": "שלבי העומק שבהם הלומד לומד ועושה שימוש במידע – מהבנה בסיסית וזכירת עובדות, דרך שימוש בידע לצורך רכישת חדש, ניתוח והסקה, ועד חשיבה מסדר גבוה הכוללת העברה בין תחומים, הערכה ויצירה. התחום נשען על מדרג בלום ומאפשר אפיון איכות הלמידה ולא רק כמות הידע."
        }
      },
      {
        name: "כישורים ומיומנויות",
        color: "#98D8C8",
        details: [
          "מיומנויות חברתיות-רגשיות",
          "מיומנויות תפקודיות", 
          "מיומנויות קוגניטיביות",
          "מיומנויות אורייניות",
          "מיומנויות דיסציפלינריות"
        ],
        subcategories: {
          "מיומנויות חברתיות-רגשיות": {
            details: [
              "תקשורת - העברת מסר",
              "עבודת צוות",
              "מודעות והתנהלות חברתית",
              "מודעות עצמית"
            ],
            legend: {
              "תקשורת - העברת מסר": "יכולת להעביר מסר בבהירות, יכולת להציג נושא מול קהל (פרזנטציה)",
              "עבודת צוות": "יכולת לקבל ולחלוק מידע, ביצוע משימות באופן שיתופי, הכרת החוזקות והתרומה שלי לצוות וזיהוי תחומים בהם אתרם, קבלת החלטות משותפת תוך ראיית טובת הכלל, לדעת להביע ולקבל דעות והסתייגויות, גמישות תפקודית, מנהיגות והובלה",
              "מודעות והתנהלות חברתית": "יכולת לזהות נורמות חברתיות ולפעול על פיהן, יכולת לנווט במצבים חברתיים- הבנת מסרים מרומזים מילוליים ובלתי מילוליים, יכולת לזהות מצבי פגיעה בזולת ומצבים בהם אחרים זקוקים לעזרה, מתן כבוד לזולת, אמפתיה לזולת, הבנת השפעת פעולות הפרט על אחרים, רגישות תרבותית",
              "מודעות עצמית": "הכרת הרגשות, החוזקות והחולשות האישיות, יכולת לזהות ולווסת רגשות, הבנת השפעת הרגשות על התנהגות ועל אחרים"
            }
          },
          "מיומנויות תפקודיות": {
            details: [
              "ניהול עצמי",
              "חוסן והסתגלות לשינויים"
            ],
            legend: {
              "ניהול עצמי": "הצבת מטרות ויעדים, תכנון וארגון סדר הפעולות ולוחות הזמנים להשגת המטרה, הוצאה לפועל של התוכנית בהתמדה, ביעילות ובהתאם לתכנון, ניהול זמן, תיעדוף משימות והבחנה בן עיקר לטפל, יכולת לבצע בקרה ולשנות את ההתנהלות בהתאם לשינויים ואילוצים",
              "חוסן והסתגלות לשינויים": "הבנה של המציאות הסובבת, גמישות התנהגותית - נכונות להשתנות ולהתאים עצמי למצב, סובלנות לעמימות והתמודדות רגשית ותפקודית אפקטיבית עם חוסר ודאות, נכונות לגשת ולהתנסות בדברים חדשים, יכולת למידה מהירה של מצבים ונושאים חדשים, יכולת להתמודד עם אתגרים, מצוקות ולחצים תוך כדי שמירה על תפקוד מיטבי, התאוששות מהירה וצמיחה אישית"
            }
          },
          "מיומנויות קוגניטיביות": {
            details: [
              "חשיבה ביקורתית",
              "חשיבה יצירתית ופתרון בעיות",
              "קבלת החלטות"
            ],
            legend: {
              "חשיבה ביקורתית": "הטלת ספק והבחנה בין דעות לעובדות, הערכת אמינות מקורות המידע, שקילת עמדות וטענות מתוך איסוף נתונים תומכים או מפריכים, בחינת חלופות, שיפוט ערכי ומודעות להטיות",
              "חשיבה יצירתית ופתרון בעיות": "מקוריות - פתיחות לרעיונות חדשים, יכולת לחשוב מחוץ לקופסא, להפתיע, גמישות מחשבתית - היכולת לחשוב במגוון דרכים, מנקודות מבט לא קונבנציונליות, להכיל מורכבות בחשיבה, יצירת הקשרים חדשים ו/או ידע חדש (בין מושגים או רעיונות, בין פרטי מידע), איסוף נתונים שיטתי - יכולת לאסוף את המידע על הבעיה ולארגנו בצורה מסודרת ושיטתית, ניתוח נתונים אנאליטי - היכולת לנתח את המידע, להבין איך לחבר בין חלקי ידע שונים כדי לייצר תהליך לוגי למענה לבעיה",
              "קבלת החלטות": "היכולת להגדיר בעיה ולבצע תהליך מושכל של איסוף מידע, הגדרת חלופות ושיקולים והערכת החלופות. שילוב אינטגרטיבי של ידע, ניסיון, אינטואיציה ורגשות בתהליך קבלת ההחלטה. בחירת חלופה מיטבית ולקיחת אחריות על תוצאת ההחלטה."
            }
          },
          "מיומנויות אורייניות": {
            details: [
              "אוריינות לשונית – איתור מידע, פרשנות והיסק",
              "אוריינות לשונית – הבעה בכתב",
              "אוריינות לשונית – הבעה בעל פה",
              "חשיבה ביקורתית – טיעון",
              "חשיבה יצירתית – סקרנות ומקוריות",
              "חשיבה יצירתית – גמישות מחשבתית",
              "חשיבה יצירתית – יצירת הקשרים חדשים",
              "אוריינות דיגיטלית – צריכה ויצירה של תוכן",
              "אוריינות מידע – כלל יכולות הליבה"
            ]
          },
          "מיומנויות דיסציפלינריות": {
            details: [
              "משתנה בין תחומי הדעת"
            ]
          }
        }
      },
      {
        name: "מוטיבציה",
        color: "#F7DC6F",
        details: [
          "סוג מוטיבציה: פנימית או חיצונית או התרסה",
          "עוצמת מוטיבציה",
          "קשר, שייכות ובטחון",
          "אוטונומיה",
          "מצפן פנימי",
          "מסוגלות"
        ]
      },
      {
        name: "זהות וערכים",
        color: "#DDA0DD",
        details: []
      },
      {
        name: "מאפייני למידה",
        color: "#FFA07A",
        details: [
          "נוכחות ומעורבות בלמידה",
          "רמת השקעה והתמדה",
          "עצמאות בלמידה",
          "שימוש באסטרטגיות למידה",
          "בקשת עזרה",
          "תגובה למשוב",
          "העדפות אישיות בלמידה"
        ],
        legend: {
          "נוכחות ומעורבות בלמידה": "נוכחות בשיעורים, השתתפות בדיונים, תגובה במשימות סינכרוניות וא־סינכרוניות, עמידה בזמנים.",
          "רמת השקעה והתמדה": "המאמץ והעקביות שהלומד משקיע לאורך זמן, גם במצבי קושי או עייפות.",
          "עצמאות בלמידה": "היכולת של הלומד לנהל את למידתו באופן עצמאי, לבחור דרכי פעולה ולפתור בעיות מבלי להסתמך תמיד על אחרים.",
          "שימוש באסטרטגיות למידה": "היכולת לבחור וליישם אסטרטגיות למידה יעילות בהתאם למשימה ולמטרה.",
          "בקשת עזרה": "היכולת לזהות קושי ולפנות ביוזמה לקבלת סיוע מתאים ממורה, חבר או מערכת דיגיטלית.",
          "תגובה למשוב": "היכולת להבין, לקבל וליישם משוב בצורה בונה כחלק מתהליך למידה מתמשך.",
          "העדפות אישיות בלמידה": "הדרכים והסגנונות הייחודיים שבהם הלומד מעדיף ללמוד ולעבד מידע."
        }
      }
    ];

    let selectedCategory = null;
    let selectedSubcategory = null;
    let subCircles = [];
    let subSubCircles = [];

    function createCircles() {
      const container = document.getElementById('circlesContainer');
      const centerX = 300;
      const centerY = 300;
      const radius = 180;
      
      categories.forEach((category, index) => {
        const angle = (index * 360 / categories.length) * Math.PI / 180;
        const x = centerX + radius * Math.cos(angle);
        const y = centerY + radius * Math.sin(angle);
        
        const circle = document.createElement('div');
        circle.className = 'main-circle';
        circle.setAttribute('data-index', index);
        circle.style.left = `${x - 70}px`;
        circle.style.top = `${y - 70}px`;
        circle.style.backgroundColor = category.color;
        
        const label = document.createElement('div');
        label.className = 'circle-label';
        label.textContent = category.name;
        circle.appendChild(label);
        
        circle.addEventListener('click', () => selectCategory(index));
        
        container.appendChild(circle);
      });
    }

    function createSubCircles(categoryIndex) {
      const container = document.getElementById('circlesContainer');
      const category = categories[categoryIndex];
      const mainCircle = container.querySelector(`[data-index="${categoryIndex}"]`);
      const mainRect = mainCircle.getBoundingClientRect();
      const containerRect = container.getBoundingClientRect();
      
      const mainX = mainRect.left - containerRect.left + 70;
      const mainY = mainRect.top - containerRect.top + 70;
      
      // מחיקת עיגולי משנה קיימים
      clearSubCircles();
      clearSubSubCircles();
      
      category.details.forEach((detail, index) => {
        const angle = (index * 360 / category.details.length) * Math.PI / 180;
        const distance = 160;
        const x = mainX + distance * Math.cos(angle);
        const y = mainY + distance * Math.sin(angle);
        
        const subCircle = document.createElement('div');
        subCircle.className = 'sub-circle';
        subCircle.setAttribute('data-subcategory', detail);
        subCircle.style.left = `${x - 60}px`;
        subCircle.style.top = `${y - 60}px`;
        subCircle.style.borderColor = category.color;
        subCircle.style.color = category.color;
        subCircle.textContent = detail;
        subCircle.title = detail;
        
        // הוספת עיכוב לאנימציה
        setTimeout(() => {
          subCircle.classList.add('show');
        }, index * 100);
        
        subCircle.addEventListener('click', (e) => {
          e.stopPropagation();
          if (category.subcategories && category.subcategories[detail]) {
            selectSubcategory(categoryIndex, detail, subCircle);
          } else {
            showDetailTooltip(detail, e.target);
          }
        });
        
        container.appendChild(subCircle);
        subCircles.push(subCircle);
      });
    }

    function createSubSubCircles(categoryIndex, subcategoryName, parentCircle) {
      const container = document.getElementById('circlesContainer');
      const category = categories[categoryIndex];
      const subcategory = category.subcategories[subcategoryName];
      
      if (!subcategory || !subcategory.details) return;
      
      const parentRect = parentCircle.getBoundingClientRect();
      const containerRect = container.getBoundingClientRect();
      
      const parentX = parentRect.left - containerRect.left + 60;
      const parentY = parentRect.top - containerRect.top + 60;
      
      // מחיקת עיגולי משנה-משנה קיימים
      clearSubSubCircles();
      
      subcategory.details.forEach((detail, index) => {
        const angle = (index * 360 / subcategory.details.length) * Math.PI / 180;
        const distance = 120;
        const x = parentX + distance * Math.cos(angle);
        const y = parentY + distance * Math.sin(angle);
        
        const subSubCircle = document.createElement('div');
        subSubCircle.className = 'sub-circle';
        subSubCircle.style.left = `${x - 50}px`;
        subSubCircle.style.top = `${y - 50}px`;
        subSubCircle.style.width = '100px';
        subSubCircle.style.height = '100px';
        subSubCircle.style.borderColor = category.color;
        subSubCircle.style.color = category.color;
        subSubCircle.style.fontSize = '10px';
        subSubCircle.textContent = detail;
        subSubCircle.title = detail;
        
        // הוספת עיכוב לאנימציה
        setTimeout(() => {
          subSubCircle.classList.add('show');
        }, index * 100);
        
        subSubCircle.addEventListener('click', (e) => {
          e.stopPropagation();
          showDetailTooltip(detail, e.target);
        });
        
        container.appendChild(subSubCircle);
        subSubCircles.push(subSubCircle);
      });
    }

    function clearSubCircles() {
      subCircles.forEach(circle => {
        circle.remove();
      });
      subCircles = [];
    }

    function clearSubSubCircles() {
      subSubCircles.forEach(circle => {
        circle.remove();
      });
      subSubCircles = [];
    }

    function selectSubcategory(categoryIndex, subcategoryName, subCircle) {
      if (selectedSubcategory === subcategoryName) {
        selectedSubcategory = null;
        clearSubSubCircles();
        subCircles.forEach(circle => {
          circle.classList.remove('active', 'dimmed');
        });
        showDetails(categoryIndex);
      } else {
        selectedSubcategory = subcategoryName;
        subCircles.forEach(circle => {
          circle.classList.remove('active', 'dimmed');
          if (circle.getAttribute('data-subcategory') === subcategoryName) {
            circle.classList.add('active');
          } else {
            circle.classList.add('dimmed');
          }
        });
        createSubSubCircles(categoryIndex, subcategoryName, subCircle);
        showSubcategoryDetails(categoryIndex, subcategoryName);
      }
    }

    function showDetailTooltip(detail, element) {
      // הסרת tooltip קיים
      const existingTooltip = document.querySelector('.detail-tooltip');
      if (existingTooltip) {
        existingTooltip.remove();
      }
      
      const tooltip = document.createElement('div');
      tooltip.className = 'detail-tooltip';
      tooltip.textContent = detail;
      tooltip.style.cssText = `
        position: absolute;
        background: rgba(0,0,0,0.9);
        color: white;
        padding: 8px 12px;
        border-radius: 8px;
        font-size: 12px;
        max-width: 200px;
        z-index: 1000;
        pointer-events: none;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      `;
      
      const rect = element.getBoundingClientRect();
      const containerRect = document.getElementById('circlesContainer').getBoundingClientRect();
      
      tooltip.style.left = `${rect.left - containerRect.left + 30}px`;
      tooltip.style.top = `${rect.top - containerRect.top - 40}px`;
      
      document.getElementById('circlesContainer').appendChild(tooltip);
      
      // הסרת tooltip אחרי 3 שניות
      setTimeout(() => {
        if (tooltip.parentNode) {
          tooltip.remove();
        }
      }, 3000);
    }

    function selectCategory(index) {
      const circles = document.querySelectorAll('.main-circle');
      
      if (selectedCategory === index) {
        selectedCategory = null;
        selectedSubcategory = null;
        circles.forEach(circle => {
          circle.classList.remove('active', 'dimmed');
        });
        clearSubCircles();
        clearSubSubCircles();
        showPlaceholder();
      } else {
        selectedCategory = index;
        selectedSubcategory = null;
        circles.forEach((circle, i) => {
          circle.classList.remove('active', 'dimmed');
          if (i === index) {
            circle.classList.add('active');
          } else {
            circle.classList.add('dimmed');
          }
        });
        clearSubSubCircles();
        createSubCircles(index);
        showDetails(index);
      }
    }

    function showPlaceholder() {
      const panel = document.getElementById('detailsPanel');
      panel.innerHTML = '<p class="placeholder-text">לחץ על אחד מהעיגולים כדי לראות פירוט</p>';
    }

    function showDetails(index) {
      const category = categories[index];
      const panel = document.getElementById('detailsPanel');
      
      if (category.details.length === 0) {
        panel.innerHTML = `
          <h2>${category.name}</h2>
          <p class="placeholder-text">פירוט יתווסף בקרוב...</p>
        `;
      } else {
        const detailsList = category.details.map(detail => {
          const definition = category.legend && category.legend[detail] ? category.legend[detail] : '';
          return `
            <li>
              <div class="detail-title">${detail}</div>
              ${definition ? `<div class="detail-definition">${definition}</div>` : ''}
            </li>
          `;
        }).join('');
        
        panel.innerHTML = `
          <h2>${category.name}</h2>
          <ul>${detailsList}</ul>
        `;
      }
    }

    function showSubcategoryDetails(categoryIndex, subcategoryName) {
      const category = categories[categoryIndex];
      const subcategory = category.subcategories[subcategoryName];
      const panel = document.getElementById('detailsPanel');
      
      if (!subcategory || !subcategory.details) {
        panel.innerHTML = `
          <h2>${subcategoryName}</h2>
          <p class="placeholder-text">פירוט יתווסף בקרוב...</p>
        `;
        return;
      }
      
      const detailsList = subcategory.details.map(detail => {
        const definition = subcategory.legend && subcategory.legend[detail] ? subcategory.legend[detail] : '';
        return `
          <li>
            <div class="detail-title">${detail}</div>
            ${definition ? `<div class="detail-definition">${definition}</div>` : ''}
          </li>
        `;
      }).join('');
      
      panel.innerHTML = `
        <h2>${subcategoryName}</h2>
        <ul>${detailsList}</ul>
      `;
    }

    async function onConfigChange(config) {
      const baseSize = config.font_size || defaultConfig.font_size;
      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontStack = 'Tahoma, Geneva, Verdana, sans-serif';
      
      document.getElementById('main-title').textContent = config.main_title || defaultConfig.main_title;
      document.getElementById('main-title').style.fontFamily = `${customFont}, ${baseFontStack}`;
      document.getElementById('main-title').style.fontSize = `${baseSize * 3}px`;
      document.getElementById('main-title').style.color = config.text_color || defaultConfig.text_color;
      
      document.body.style.background = `linear-gradient(135deg, ${config.primary_color || defaultConfig.primary_color} 0%, ${config.secondary_color || defaultConfig.secondary_color} 100%)`;
      
      const detailsPanel = document.getElementById('detailsPanel');
      detailsPanel.style.backgroundColor = config.background_color || defaultConfig.background_color;
      detailsPanel.style.fontFamily = `${customFont}, ${baseFontStack}`;
      detailsPanel.style.fontSize = `${baseSize}px`;
      
      const h2Elements = detailsPanel.querySelectorAll('h2');
      h2Elements.forEach(h2 => {
        h2.style.color = config.primary_color || defaultConfig.primary_color;
        h2.style.borderBottomColor = config.primary_color || defaultConfig.primary_color;
        h2.style.fontSize = `${baseSize * 1.75}px`;
        h2.style.fontFamily = `${customFont}, ${baseFontStack}`;
      });
      
      const liElements = detailsPanel.querySelectorAll('li');
      liElements.forEach(li => {
        li.style.borderBottomColor = config.accent_color || defaultConfig.accent_color;
      });

      const detailTitles = detailsPanel.querySelectorAll('.detail-title');
      detailTitles.forEach(title => {
        title.style.fontSize = `${baseSize}px`;
        title.style.fontFamily = `${customFont}, ${baseFontStack}`;
      });

      const detailDefinitions = detailsPanel.querySelectorAll('.detail-definition');
      detailDefinitions.forEach(definition => {
        definition.style.fontSize = `${baseSize * 0.875}px`;
        definition.style.fontFamily = `${customFont}, ${baseFontStack}`;
      });
      
      const beforeElements = detailsPanel.querySelectorAll('.detail-title:before');
      beforeElements.forEach(before => {
        before.style.color = config.primary_color || defaultConfig.primary_color;
      });
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.primary_color || defaultConfig.primary_color,
              set: (value) => {
                config.primary_color = value;
                window.elementSdk.setConfig({ primary_color: value });
              }
            },
            {
              get: () => config.secondary_color || defaultConfig.secondary_color,
              set: (value) => {
                config.secondary_color = value;
                window.elementSdk.setConfig({ secondary_color: value });
              }
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => {
                config.text_color = value;
                window.elementSdk.setConfig({ text_color: value });
              }
            },
            {
              get: () => config.background_color || defaultConfig.background_color,
              set: (value) => {
                config.background_color = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            },
            {
              get: () => config.accent_color || defaultConfig.accent_color,
              set: (value) => {
                config.accent_color = value;
                window.elementSdk.setConfig({ accent_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => config.font_family || defaultConfig.font_family,
            set: (value) => {
              config.font_family = value;
              window.elementSdk.setConfig({ font_family: value });
            }
          },
          fontSizeable: {
            get: () => config.font_size || defaultConfig.font_size,
            set: (value) => {
              config.font_size = value;
              window.elementSdk.setConfig({ font_size: value });
            }
          }
        }),
        mapToEditPanelValues: (config) => new Map([
          ["main_title", config.main_title || defaultConfig.main_title]
        ])
      });
    }

    createCircles();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99b7fc927488a9bd',t:'MTc2MjYzNTQ4Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
